<div class="container mt-5 mb-5">
  <div class="manga-detail-container">

    @if (loading) {
      <div class="loading alert alert-info">
        Carregando detalhes do mangá...
      </div>
    }

    @if (error) {
      <div class="error alert alert-danger">
        {{ error }}
      </div>
    }

    @if (successMessage) {
      <div class="alert alert-success">
        {{ successMessage }}
      </div>
    }

    @if (manga && !loading) {
      <div class="manga-content row g-4">
        
        <div class="col-lg-8">
          <div class="card manga-info">
            @if (manga.imageUrl) {
              <img [src]="manga.imageUrl" class="card-img-top" alt="{{manga.title}}" style="max-height: 500px; object-fit: cover;">
            }
            <div class="card-body">
              <h1 class="card-title">{{ manga.title }}</h1>
              <h5 class="card-subtitle mb-3 text-muted">Por {{ manga.author }}</h5>
              <p class="description card-text">{{ manga.description }}</p>
              
              <div class="manga-meta mt-4">
                @if (manga.rating) {
                  <p><strong>Rating:</strong> <span class="badge bg-primary">{{ manga.rating }}/10</span></p>
                }
                @if (manga.status) {
                  <p><strong>Status:</strong> <span class="badge bg-secondary">{{ manga.status }}</span></p>
                }
                @if (manga.genres) {
                  <p><strong>Gênero:</strong> <span class="badge bg-info text-dark">{{ manga.genres }}</span></p>
                }
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card volumes-section shadow-sm">
            <div class="card-header">
              <h5 class="mb-0">Volumes Disponíveis</h5>
            </div>
            <div class="card-body">
              @if (!manga.volumes || manga.volumes.length === 0) {
                <div class="no-volumes text-center p-3 text-muted">
                  Nenhum volume disponível no momento.
                </div>
              } @else {
                <div class="volume-selector">
                  <div class="mb-3">
                    <label for="volumeSelect" class="form-label">Selecione o Volume</label>
                    <select class="form-select" id="volumeSelect" [(ngModel)]="selectedVolume">
                      <option [ngValue]="null">Escolha um volume...</option>
                      @for (volume of manga.volumes; track volume.id) {
                        <option [ngValue]="volume" [disabled]="volume.quantity === 0">
                          Volume {{ volume.volumeNumber }} - R$ {{ volume.price | number:'1.2-2' }}
                          (Estoque: {{ volume.quantity }})
                        </option>
                      }
                    </select>
                  </div>
                  <button class="btn btn-primary w-100 add-to-cart-btn" 
                          (click)="adicionarAoCarrinho()"
                          [disabled]="!selectedVolume">
                    Adicionar ao Carrinho
                  </button>
                </div>
              }
            </div>
          </div>
        </div>
        
      </div>
    }
  </div>
</div>